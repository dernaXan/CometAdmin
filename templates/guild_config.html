{% extends 'base.html' %}

{% block head %}
  {{ super() }}
  <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css">
{% endblock %}

{% block content %}
  <h1>Einstellungen für Server {{ guild_id }}</h1>

  <form method="POST" action="/config/{{ guild_id }}">
    <div class="section">
      <h3>Moderation</h3>

      <label for="modrole">Modrolle:</label>
      <select id="modrole" name="modrole" required>
        <option value="" disabled selected>Bitte auswählen</option>
        {% for role in roles %}
          <option value="{{ role.id }}">{{ role.name }}</option>
        {% endfor %}
      </select>

      <label for="modchat">Modchat:</label>
      <select id="modchat" name="modchat" required>
        <option value="" disabled selected>Bitte auswählen</option>
        {% for channel in channels %}
          <option value="{{ channel.id }}">{{ channel.name }}</option>
        {% endfor %}
      </select>

      <label for="badwords">Badwords Filter:</label>
      <textarea id="badwords" name="badwords" placeholder="Wörter eintippen und mit Komma trennen"></textarea>
    </div>

    <div class="section">
      <h3>Punktesystem</h3>

      <label for="maxminuspoints">Maximale Minus-Punkte</label>
      <input type="number" name="maxminuspoints" id="maxminuspoints" max="-1" step="1" />

      <label for="minuspointsaction">Strafe:</label>
      <select id="minuspointsaction" name="minuspointsaction">
        <option value="0">Nichts</option>
        <option value="1">Kick</option>
        <option value="2">Bann</option>
      </select>
    </div>
  </form>

  <script>
    const badwords = document.querySelector('#badwords');
    const tagify = new Tagify(badwords, {
      delimiters: ", ",
      maxTags: 100,
      pattern: /[^,]+/,
      whitelist: [],
      dropdown: { enabled: 0 }
    });

    badwords.addEventListener('change', function () {
      console.log('Badwords:', badwords.value);
    });
  </script>
{% endblock %}
